<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文件操作 - 姚老师信奥网</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/cpp.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4A80F0', // 主色调：鲜明的蓝色
                        secondary: '#6C63FF', // 辅助色：紫色
                        syntax: '#FF9800', // 语法部分：橙色
                        algorithm: '#2ECC71', // 算法部分：绿色
                        datastructure: '#9C27B0', // 数据结构部分：深紫色
                        darkbg: '#F8FAFC', // 浅灰白背景
                        cardbg: '#FFFFFF', // 卡片背景
                        hoverbg: '#F0F2F5', // 悬停背景
                        file: '#03A9F4', // 文件操作主题色：亮蓝色
                        execution: '#FFEB3B', // 执行高亮：黄色
                    },
                    fontFamily: {
                        mono: ['Consolas', 'Monaco', 'Courier New', 'monospace'],
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .hover-scale {
                @apply transition-transform duration-300 hover:scale-[1.02];
            }
            .category-bg {
                @apply bg-gradient-to-r from-primary/5 to-primary/10;
            }
            .subcategory-bg {
                @apply bg-gradient-to-r from-secondary/5 to-secondary/10;
            }
            .file-bg {
                @apply bg-gradient-to-r from-file/5 to-file/10;
            }
            .card-shadow {
                @apply shadow-sm hover:shadow-md transition-shadow duration-300;
            }
            .nav-item {
                @apply text-gray-700 hover:text-primary transition-colors duration-200;
            }
            .topic-card {
                @apply bg-cardbg rounded-lg p-5 card-shadow hover-scale;
            }
            .subtopic-item {
                @apply bg-white rounded-md p-3 border border-gray-100 hover:border-primary/50 transition-all duration-200 cursor-pointer;
            }
            .topic-header {
                @apply text-xl font-bold text-primary mb-4 flex items-center;
            }
            .subtopic-header {
                @apply font-semibold text-secondary mb-3;
            }
            .file-header {
                @apply font-bold text-file mb-3;
            }
            .site-title {
                @apply text-2xl font-bold text-primary tracking-tight;
            }
            .code-block {
                @apply bg-gray-800 text-gray-100 rounded-lg p-4 overflow-x-auto my-4 text-sm font-mono;
            }
            .step-item {
                @apply p-3 rounded-md mb-2 border-l-4 border-file bg-file/5;
            }
            .step-number {
                @apply inline-block w-6 h-6 rounded-full bg-file text-white text-center mr-2 text-xs;
            }
            .file-operation {
                @apply border-2 border-gray-300 rounded-md p-2 mb-1 bg-gray-50 transition-all duration-500;
            }
            .file-operation-active {
                @apply border-file bg-file/10 transform scale-[1.02];
            }
            .animation-controls {
                @apply flex flex-wrap gap-2 items-center my-4;
            }
            .animation-step {
                @apply bg-gray-100 p-3 rounded-lg mb-4;
            }
            .animation-progress {
                @apply w-full bg-gray-200 rounded-full h-2.5 mb-2;
            }
            .animation-progress-bar {
                @apply bg-file h-2.5 rounded-full transition-all duration-300;
            }
            .animation-status {
                @apply text-sm text-gray-600 my-2 p-2 bg-gray-50 rounded;
            }
            .code-line {
                @apply transition-all duration-300;
            }
            .code-line-highlight {
                @apply bg-execution/30 text-gray-900 font-medium;
            }
            .file-content {
                @apply bg-gray-50 border border-gray-200 rounded-lg p-4 min-h-[120px] font-mono text-sm;
            }
        }
    </style>
</head>
<body class="bg-darkbg text-gray-800 font-sans min-h-screen">
    <!-- 顶部导航栏 -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <i class="fa fa-code text-primary text-3xl"></i>
                <h1 class="site-title">姚老师信奥网</h1>
            </div>
            <div class="hidden md:flex items-center space-x-6">
                <a href="#" class="nav-item">首页</a>
                <a href="#" class="nav-item">课程</a>
                <a href="#" class="nav-item">题库</a>
                <a href="#" class="nav-item">关于我们</a>
            </div>
            <div class="flex items-center space-x-4">
                <!-- 搜索框 -->
                <div class="relative hidden md:block">
                    <input type="text" id="search-input" placeholder="搜索算法、数据结构..." class="pl-10 pr-4 py-2 rounded-md bg-darkbg border border-gray-200 focus:outline-none focus:border-primary text-gray-700 w-64">
                    <button id="search-button" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-primary">
                        <i class="fa fa-search"></i>
                    </button>
                </div>
                <div class="md:hidden">
                    <button class="text-gray-700">
                        <i class="fa fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- 移动端搜索框 -->
        <div class="md:hidden px-4 pb-3">
            <div class="relative">
                <input type="text" id="mobile-search-input" placeholder="搜索算法、数据结构..." class="pl-10 pr-4 py-2 rounded-md bg-darkbg border border-gray-200 focus:outline-none focus:border-primary text-gray-700 w-full">
                <button id="mobile-search-button" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-primary">
                    <i class="fa fa-search"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- 面包屑导航 -->
    <div class="bg-white border-b border-gray-200 py-2">
        <div class="container mx-auto px-4">
            <nav class="flex text-sm" aria-label="Breadcrumb">
                <ol class="inline-flex items-center space-x-1 md:space-x-3">
                    <li class="inline-flex items-center">
                        <a href="#" class="text-gray-600 hover:text-primary">
                            <i class="fa fa-home mr-1"></i>首页
                        </a>
                    </li>
                    <li>
                        <div class="flex items-center">
                            <i class="fa fa-angle-right mx-2 text-gray-400"></i>
                            <a href="#" class="text-gray-600 hover:text-primary">语法基础</a>
                        </div>
                    </li>
                    <li>
                        <div class="flex items-center">
                            <i class="fa fa-angle-right mx-2 text-gray-400"></i>
                            <a href="#" class="text-gray-600 hover:text-primary">文件操作</a>
                        </div>
                    </li>
                    <li aria-current="page">
                        <div class="flex items-center">
                            <i class="fa fa-angle-right mx-2 text-gray-400"></i>
                            <span class="text-file font-medium">C++文件操作</span>
                        </div>
                    </li>
                </ol>
            </nav>
        </div>
    </div>

    <!-- 主要内容区 -->
    <main class="container mx-auto px-4 py-8">
        <!-- 页面标题 -->
        <div class="file-bg rounded-lg p-6 mb-8">
            <div class="flex flex-col md:flex-row md:items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-file mb-2">C++文件操作</h1>
                    <p class="text-gray-700">
                        文件操作是信息学奥赛中的重要技能，用于数据的持久化存储和读取。本页面将详细讲解C++中文本文件和二进制文件的操作方法，
                        包括文件的打开、读写、关闭等核心操作，帮助NOIP竞赛学生掌握程序数据处理的关键技能。
                    </p>
                </div>
                <div class="mt-4 md:mt-0">
                    <div class="flex space-x-3">
                        <a href="#concept" class="bg-file hover:bg-file/90 text-white px-4 py-2 rounded-md transition-all flex items-center">
                            <i class="fa fa-book mr-2"></i> 学习概念
                        </a>
                        <a href="#problems" class="bg-white border border-file text-file hover:bg-file/5 px-4 py-2 rounded-md transition-all flex items-center">
                            <i class="fa fa-list-alt mr-2"></i> 查看题目
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- 文件操作概述 -->
        <section id="concept" class="topic-card mb-8">
            <h2 class="text-2xl font-bold text-file mb-6 flex items-center">
                <i class="fa fa-info-circle mr-2"></i> 文件操作概述
            </h2>
            <div class="space-y-4">
                <div>
                    <h3 class="text-xl font-semibold mb-3">为什么需要文件操作？</h3>
                    <p class="text-gray-700">
                        在信息学竞赛中，程序通常需要处理大量数据，这些数据无法通过手动输入完成。文件操作允许程序从外部文件读取数据，
                        并将处理结果写入文件，是解决大规模数据问题的必要技能。
                    </p>
                    <div class="bg-gray-50 p-4 rounded-lg mt-3">
                        <h4 class="font-semibold mb-2">竞赛中文件操作的应用场景：</h4>
                        <ul class="list-disc pl-5 space-y-2">
                            <li>处理超过控制台输入能力的大规模数据</li>
                            <li>保存中间计算结果，避免重复计算</li>
                            <li>实现数据的持久化存储</li>
                            <li>按要求格式输出结果便于检查</li>
                            <li>在部分竞赛中，标准输入输出会被文件输入输出替代</li>
                        </ul>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-xl font-semibold mb-3">C++文件操作的基本步骤</h3>
                    <p class="text-gray-700 mb-3">
                        C++通过fstream库实现文件操作，基本步骤包括：
                    </p>
                    
                    <div class="space-y-3 mb-4">
                        <div class="step-item">
                            <span class="step-number">1</span>
                            <strong>包含头文件</strong>：引入&lt;fstream&gt;头文件
                        </div>
                        <div class="step-item">
                            <span class="step-number">2</span>
                            <strong>创建文件流对象</strong>：根据操作类型创建ifstream(读)、ofstream(写)或fstream(读写)对象
                        </div>
                        <div class="step-item">
                            <span class="step-number">3</span>
                            <strong>打开文件</strong>：使用open()方法或构造函数打开文件，并指定打开模式
                        </div>
                        <div class="step-item">
                            <span class="step-number">4</span>
                            <strong>操作文件</strong>：进行读或写操作
                        </div>
                        <div class="step-item">
                            <span class="step-number">5</span>
                            <strong>关闭文件</strong>：使用close()方法关闭文件
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-file mb-2">常用文件打开模式</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
                            <div class="p-2 bg-white rounded border border-gray-200">
                                <strong>ios::in</strong> - 以读方式打开文件
                            </div>
                            <div class="p-2 bg-white rounded border border-gray-200">
                                <strong>ios::out</strong> - 以写方式打开文件，会清空原有内容
                            </div>
                            <div class="p-2 bg-white rounded border border-gray-200">
                                <strong>ios::app</strong> - 以追加方式打开文件，新内容添加到末尾
                            </div>
                            <div class="p-2 bg-white rounded border border-gray-200">
                                <strong>ios::binary</strong> - 以二进制方式打开文件
                            </div>
                            <div class="p-2 bg-white rounded border border-gray-200">
                                <strong>ios::trunc</strong> - 如果文件存在则清空文件内容
                            </div>
                            <div class="p-2 bg-white rounded border border-gray-200">
                                <strong>ios::ate</strong> - 打开文件后定位到文件末尾
                            </div>
                        </div>
                        <p class="mt-3 text-sm text-gray-600">
                            模式可以组合使用，例如：ios::in | ios::out 表示同时读写
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 文件操作动画演示 -->
        <section class="topic-card mb-8">
            <h2 class="text-2xl font-bold text-file mb-6 flex items-center">
                <i class="fa fa-play-circle mr-2"></i> 文件读写过程演示
            </h2>
            
            <div class="space-y-6">
                <!-- 文件操作动画 -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-lg mb-3">文本文件读写完整过程</h3>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-1">
                            <p class="text-gray-700 mb-4">
                                下面的动画展示了从文件读取数据、处理数据并将结果写入新文件的完整过程。
                                示例实现从文件读取整数，计算平方后写入另一个文件。
                            </p>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">输入数据(每行一个整数):</label>
                                <textarea id="input-data" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:border-file h-32" rows="5">3
5
7
9
11</textarea>
                            </div>
                            
                            <div class="flex space-x-2">
                                <button id="file-run" class="bg-file hover:bg-file/90 text-white px-4 py-2 rounded-md transition-all flex items-center">
                                    <i class="fa fa-play mr-2"></i> 运行演示
                                </button>
                                <button id="file-reset" class="bg-white border border-gray-300 text-gray-700 px-4 py-2 rounded-md transition-all flex items-center">
                                    <i class="fa fa-refresh mr-2"></i> 重置
                                </button>
                            </div>
                            
                            <div id="file-status" class="animation-status hidden">
                                状态: 等待开始
                            </div>
                        </div>
                        
                        <div class="lg:col-span-1">
                            <div class="mb-4">
                                <h4 class="font-medium text-gray-700 mb-2">input.txt 内容</h4>
                                <div id="input-file-content" class="file-content">
                                    (将显示输入文件内容)
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-700 mb-2">output.txt 内容</h4>
                                <div id="output-file-content" class="file-content">
                                    (将显示输出文件内容)
                                </div>
                            </div>
                        </div>
                        
                        <div class="lg:col-span-1">
                            <div class="bg-gray-800 text-gray-100 rounded-lg p-4 h-64 overflow-y-auto font-mono text-sm" id="file-code">
                                <div class="code-line" id="fcode-1">#include &lt;iostream&gt;</div>
                                <div class="code-line" id="fcode-2">#include &lt;fstream&gt;</div>
                                <div class="code-line" id="fcode-3">using namespace std;</div>
                                <div class="code-line" id="fcode-4">&nbsp;</div>
                                <div class="code-line" id="fcode-5">int main() {</div>
                                <div class="code-line" id="fcode-6">&nbsp;&nbsp;// 创建文件流对象</div>
                                <div class="code-line" id="fcode-7">&nbsp;&nbsp;ifstream inFile;</div>
                                <div class="code-line" id="fcode-8">&nbsp;&nbsp;ofstream outFile;</div>
                                <div class="code-line" id="fcode-9">&nbsp;&nbsp;</div>
                                <div class="code-line" id="fcode-10">&nbsp;&nbsp;// 打开文件</div>
                                <div class="code-line" id="fcode-11">&nbsp;&nbsp;inFile.open("input.txt"); // 读方式打开</div>
                                <div class="code-line" id="fcode-12">&nbsp;&nbsp;outFile.open("output.txt"); // 写方式打开</div>
                                <div class="code-line" id="fcode-13">&nbsp;&nbsp;</div>
                                <div class="code-line" id="fcode-14">&nbsp;&nbsp;int num;</div>
                                <div class="code-line" id="fcode-15">&nbsp;&nbsp;// 读取数据直到文件结束</div>
                                <div class="code-line" id="fcode-16">&nbsp;&nbsp;while (inFile >> num) {</div>
                                <div class="code-line" id="fcode-17">&nbsp;&nbsp;&nbsp;&nbsp;// 计算平方</div>
                                <div class="code-line" id="fcode-18">&nbsp;&nbsp;&nbsp;&nbsp;int square = num * num;</div>
                                <div class="code-line" id="fcode-19">&nbsp;&nbsp;&nbsp;&nbsp;// 写入结果</div>
                                <div class="code-line" id="fcode-20">&nbsp;&nbsp;&nbsp;&nbsp;outFile << square << endl;</div>
                                <div class="code-line" id="fcode-21">&nbsp;&nbsp;}</div>
                                <div class="code-line" id="fcode-22">&nbsp;&nbsp;</div>
                                <div class="code-line" id="fcode-23">&nbsp;&nbsp;// 关闭文件</div>
                                <div class="code-line" id="fcode-24">&nbsp;&nbsp;inFile.close();</div>
                                <div class="code-line" id="fcode-25">&nbsp;&nbsp;outFile.close();</div>
                                <div class="code-line" id="fcode-26">&nbsp;&nbsp;</div>
                                <div class="code-line" id="fcode-27">&nbsp;&nbsp;return 0;</div>
                                <div class="code-line" id="fcode-28">}</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 文件操作类型对比 -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-lg mb-3">不同类型的文件操作</h3>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white p-4 rounded-lg border border-gray-200">
                            <h4 class="font-semibold text-file mb-2">文本文件读取</h4>
                            <pre class="code-block text-xs"><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;fstream&gt;
using namespace std;

int main() {
    // 创建输入文件流对象并打开文件
    ifstream in("data.txt");
    
    // 检查文件是否成功打开
    if (!in.is_open()) {
        cout << "无法打开文件" << endl;
        return 1;
    }
    
    // 读取数据
    int num;
    while (in >> num) { // 逐个读取整数
        cout << num << " ";
    }
    
    // 关闭文件
    in.close();
    return 0;
}</code></pre>
                            <p class="text-gray-700 text-sm mt-3">
                                文本文件以字符形式存储数据，适合人类阅读，可使用>>运算符或getline()函数读取。
                            </p>
                        </div>
                        
                        <div class="bg-white p-4 rounded-lg border border-gray-200">
                            <h4 class="font-semibold text-file mb-2">文本文件写入</h4>
                            <pre class="code-block text-xs"><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;fstream&gt;
using namespace std;

int main() {
    // 创建输出文件流对象并打开文件
    ofstream out("result.txt");
    
    // 检查文件是否成功打开
    if (!out.is_open()) {
        cout << "无法创建文件" << endl;
        return 1;
    }
    
    // 写入数据
    for (int i = 1; i <= 10; i++) {
        out << i << " " << i*i << endl; // 写入平方表
    }
    
    // 关闭文件
    out.close();
    return 0;
}</code></pre>
                            <p class="text-gray-700 text-sm mt-3">
                                使用<<运算符向文本文件写入数据，数据会被转换为字符形式存储。
                            </p>
                        </div>
                        
                        <div class="bg-white p-4 rounded-lg border border-gray-200">
                            <h4 class="font-semibold text-file mb-2">二进制文件读取</h4>
                            <pre class="code-block text-xs"><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;fstream&gt;
using namespace std;

struct Student {
    int id;
    char name[20];
    int score;
};

int main() {
    // 以二进制方式打开文件
    ifstream in("students.dat", ios::binary);
    
    Student s;
    // 读取结构体数据
    while (in.read((char*)&s, sizeof(s))) {
        cout << s.id << " " << s.name << " " << s.score << endl;
    }
    
    in.close();
    return 0;
}</code></pre>
                            <p class="text-gray-700 text-sm mt-3">
                                二进制文件直接存储数据的内存表示形式，使用read()方法读取，速度更快。
                            </p>
                        </div>
                        
                        <div class="bg-white p-4 rounded-lg border border-gray-200">
                            <h4 class="font-semibold text-file mb-2">二进制文件写入</h4>
                            <pre class="code-block text-xs"><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;fstream&gt;
using namespace std;

struct Student {
    int id;
    char name[20];
    int score;
};

int main() {
    // 以二进制方式打开文件
    ofstream out("students.dat", ios::binary);
    
    Student s = {1001, "ZhangSan", 95};
    // 写入结构体数据
    out.write((char*)&s, sizeof(s));
    
    s = {1002, "LiSi", 88};
    out.write((char*)&s, sizeof(s));
    
    out.close();
    return 0;
}</code></pre>
                            <p class="text-gray-700 text-sm mt-3">
                                使用write()方法写入二进制数据，适合存储结构化数据，节省空间且读写效率高。
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 文件操作技巧与注意事项 -->
        <section class="topic-card mb-8">
            <h2 class="text-2xl font-bold text-file mb-6 flex items-center">
                <i class="fa fa-exclamation-circle mr-2"></i> 文件操作技巧与注意事项
            </h2>
            
            <div class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-semibold text-lg mb-3">竞赛常用技巧</h3>
                        
                        <div class="mb-4">
                            <h4 class="font-semibold text-file mb-2">快速替换标准输入输出</h4>
                            <pre class="code-block text-xs"><code class="language-cpp">#include &lt;fstream&gt;
using namespace std;

// 在程序开始处添加以下代码，即可将标准输入输出重定向到文件
ifstream fin("input.txt");
ofstream fout("output.txt");
#define cin fin
#define cout fout

int main() {
    // 原本的cin和cout操作现在会读写文件
    int a, b;
    cin >> a >> b;
    cout << a + b << endl;
    return 0;
}</code></pre>
                            <p class="text-gray-700 text-sm mt-2">
                                这种方式可以在不修改原有代码逻辑的情况下，将控制台输入输出改为文件操作。
                            </p>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold text-file mb-2">检查文件操作状态</h4>
                            <pre class="code-block text-xs"><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;fstream&gt;
using namespace std;

int main() {
    ifstream in("data.txt");
    
    // 检查文件是否成功打开
    if (!in) {
        cerr << "无法打开文件 data.txt" << endl;
        return 1;
    }
    
    int num;
    // 读取并处理数据
    while (in >> num) {
        // 处理num
    }
    
    // 检查是否因为文件结束而退出循环
    if (in.eof()) {
        cout << "文件读取完毕" << endl;
    } else {
        cout << "读取过程中发生错误" << endl;
    }
    
    in.close();
    return 0;
}</code></pre>
                            <p class="text-gray-700 text-sm mt-2">
                                检查文件状态可以帮助调试，避免因文件不存在或格式错误导致的程序异常。
                            </p>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-semibold text-lg mb-3">注意事项</h3>
                        <div class="space-y-3">
                            <div class="p-3 bg-white rounded border border-gray-200">
                                <h4 class="font-medium text-file">文件路径问题</h4>
                                <p class="text-sm text-gray-700">
                                    竞赛中建议使用相对路径，将输入输出文件与程序放在同一目录下，避免使用绝对路径。
                                </p>
                            </div>
                            
                            <div class="p-3 bg-white rounded border border-gray-200">
                                <h4 class="font-medium text-file">文件关闭</h4>
                                <p class="text-sm text-gray-700">
                                    完成文件操作后必须关闭文件，否则可能导致数据丢失。文件流对象销毁时也会自动关闭文件，但养成显式关闭的习惯更好。
                                </p>
                            </div>
                            
                            <div class="p-3 bg-white rounded border border-gray-200">
                                <h4 class="font-medium text-file">数据同步</h4>
                                <p class="text-sm text-gray-700">
                                    写入文件的数据可能会被缓冲，使用flush()方法可以强制将缓冲区数据写入文件，确保数据及时保存。
                                </p>
                            </div>
                            
                            <div class="p-3 bg-white rounded border border-gray-200">
                                <h4 class="font-medium text-file">文件重名问题</h4>
                                <p class="text-sm text-gray-700">
                                    以ios::out模式打开已存在的文件会清空原有内容，如需保留原有内容应使用ios::app模式追加。
                                </p>
                            </div>
                            
                            <div class="p-3 bg-white rounded border border-gray-200">
                                <h4 class="font-medium text-file">二进制与文本区别</h4>
                                <p class="text-sm text-gray-700">
                                    文本文件适合存储人类可读的数据，二进制文件适合存储结构化数据且读写效率更高，竞赛中根据需求选择合适的类型。
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 文件操作代码示例 -->
        <section class="topic-card mb-8">
            <h2 class="text-2xl font-bold text-file mb-6 flex items-center">
                <i class="fa fa-code mr-2"></i> 文件操作代码示例 (C++)
            </h2>
            
            <div class="space-y-6">
                <!-- 基础文件复制示例 -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-lg mb-3">1. 文件复制程序</h3>
                    <p class="text-gray-700 mb-3">
                        将一个文本文件的内容复制到另一个文本文件
                    </p>
                    
                    <pre class="code-block"><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;string&gt;
using namespace std;

int main() {
    // 打开源文件和目标文件
    ifstream source("source.txt");
    ofstream destination("destination.txt");
    
    // 检查文件是否成功打开
    if (!source.is_open() || !destination.is_open()) {
        cerr << "无法打开文件" << endl;
        return 1;
    }
    
    string line;
    // 逐行读取并写入
    while (getline(source, line)) {
        destination << line << endl;
    }
    
    cout << "文件复制完成" << endl;
    
    // 关闭文件
    source.close();
    destination.close();
    
    return 0;
}</code></pre>
                </div>
                
                <!-- 数据统计示例 -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-lg mb-3">2. 数据统计分析</h3>
                    <p class="text-gray-700 mb-3">
                        从文件读取一组整数，计算并输出统计信息到文件
                    </p>
                    
                    <pre class="code-block"><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;vector&gt;
#include &lt;algorithm&gt;
using namespace std;

int main() {
    ifstream in("numbers.txt");
    ofstream out("statistics.txt");
    
    if (!in || !out) {
        cerr << "文件打开失败" << endl;
        return 1;
    }
    
    vector<int> nums;
    int num;
    
    // 读取所有数据
    while (in >> num) {
        nums.push_back(num);
    }
    
    if (nums.empty()) {
        out << "文件中没有数据" << endl;
        return 0;
    }
    
    // 计算统计信息
    int sum = 0;
    for (int n : nums) {
        sum += n;
    }
    double average = static_cast<double>(sum) / nums.size();
    int min_val = *min_element(nums.begin(), nums.end());
    int max_val = *max_element(nums.begin(), nums.end());
    
    // 写入结果
    out << "数据个数: " << nums.size() << endl;
    out << "总和: " << sum << endl;
    out << "平均值: " << average << endl;
    out << "最小值: " << min_val << endl;
    out << "最大值: " << max_val << endl;
    
    in.close();
    out.close();
    
    return 0;
}</code></pre>
                </div>
                
                <!-- 二进制文件操作示例 -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-lg mb-3">3. 二进制文件操作</h3>
                    <p class="text-gray-700 mb-3">
                        使用二进制文件存储和读取结构体数组（学生信息）
                    </p>
                    
                    <pre class="code-block"><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;cstring&gt;
using namespace std;

// 定义学生结构体
struct Student {
    int id;          // 学号
    char name[20];   // 姓名
    float score;     // 成绩
};

// 写入学生数据到二进制文件
void writeStudents(const char* filename, Student* students, int count) {
    ofstream out(filename, ios::binary);
    if (!out) {
        cerr << "无法创建文件 " << filename << endl;
        return;
    }
    // 写入整个数组
    out.write((char*)students, count * sizeof(Student));
    out.close();
}

// 从二进制文件读取学生数据
int readStudents(const char* filename, Student* students, int maxCount) {
    ifstream in(filename, ios::binary);
    if (!in) {
        cerr << "无法打开文件 " << filename << endl;
        return 0;
    }
    
    // 定位到文件末尾获取文件大小
    in.seekg(0, ios::end);
    int fileSize = in.tellg();
    // 计算可以读取的学生数量
    int count = fileSize / sizeof(Student);
    if (count > maxCount) count = maxCount;
    
    // 定位到文件开头
    in.seekg(0, ios::beg);
    // 读取数据
    in.read((char*)students, count * sizeof(Student));
    in.close();
    
    return count;
}

int main() {
    // 创建学生数据
    Student students[3] = {
        {1001, "WangHong", 92.5},
        {1002, "LiMing", 87.0},
        {1003, "ZhangWei", 95.5}
    };
    
    // 写入文件
    writeStudents("students.dat", students, 3);
    cout << "已写入 " << 3 << " 个学生数据" << endl;
    
    // 读取文件
    Student readStudentsArray[10];
    int count = readStudents("students.dat", readStudentsArray, 10);
    cout << "已读取 " << count << " 个学生数据" << endl;
    
    // 显示读取的数据
    for (int i = 0; i < count; i++) {
        cout << "学号: " << readStudentsArray[i].id 
             << ", 姓名: " << readStudentsArray[i].name 
             << ", 成绩: " << readStudentsArray[i].score << endl;
    }
    
    return 0;
}</code></pre>
                </div>
                
                <!-- 综合应用示例 -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-lg mb-3">4. 综合应用 - 单词频率统计</h3>
                    <p class="text-gray-700 mb-3">
                        从文本文件读取内容，统计每个单词出现的频率并写入结果文件
                    </p>
                    
                    <pre class="code-block"><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;map&gt;
#include &lt;string&gt;
#include &lt;cctype&gt;
using namespace std;

// 将字符串转换为小写
string toLower(const string& s) {
    string res = s;
    for (char& c : res) {
        c = tolower(c);
    }
    return res;
}

// 清理单词，去除非字母字符
string cleanWord(const string& s) {
    string res;
    for (char c : s) {
        if (isalpha(c)) {
            res += c;
        }
    }
    return res;
}

int main() {
    ifstream in("article.txt");
    ofstream out("word_count.txt");
    
    if (!in || !out) {
        cerr << "文件打开失败" << endl;
        return 1;
    }
    
    map<string, int> wordCount;
    string word;
    
    // 读取每个单词
    while (in >> word) {
        // 处理单词：清理并转为小写
        word = cleanWord(word);
        if (word.empty()) continue;
        word = toLower(word);
        
        // 统计频率
        wordCount[word]++;
    }
    
    // 写入结果
    out << "单词总数: " << wordCount.size() << endl << endl;
    out << "单词频率统计:" << endl;
    for (const auto& pair : wordCount) {
        out << pair.first << ": " << pair.second << endl;
    }
    
    cout << "单词频率统计完成，结果已写入 word_count.txt" << endl;
    
    in.close();
    out.close();
    
    return 0;
}</code></pre>
                </div>
            </div>
        </section>

        <!-- 文件操作竞赛应用 -->
        <section class="topic-card mb-8">
            <h2 class="text-2xl font-bold text-file mb-6 flex items-center">
                <i class="fa fa-trophy mr-2"></i> 文件操作竞赛应用
            </h2>
            
            <div class="space-y-6">
                <div>
                    <h3 class="text-xl font-semibold mb-3">竞赛中文件操作的常见场景</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-file mb-2">大数据处理</h4>
                            <p class="text-gray-700">
                                当输入数据量很大（数万甚至数十万行）时，必须使用文件操作。例如处理大规模的图数据、数列数据等。
                            </p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-file mb-2">中间结果保存</h4>
                            <p class="text-gray-700">
                                在复杂算法中，可将中间计算结果保存到文件，避免重复计算，提高程序效率，尤其适用于动态规划等算法。
                            </p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-file mb-2">多阶段处理</h4>
                            <p class="text-gray-700">
                                对于多阶段问题，可以将第一阶段的输出作为第二阶段的输入，通过文件实现不同阶段之间的数据传递。
                            </p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-file mb-2">数据验证与调试</h4>
                            <p class="text-gray-700">
                                将程序的中间结果写入文件，便于检查算法执行过程是否正确，是竞赛中调试程序的重要手段。
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        // 初始化高亮显示
        document.addEventListener('DOMContentLoaded', function() {
            // 代码高亮
            hljs.highlightAll();
            
            // 文件操作演示相关元素
            const runBtn = document.getElementById('file-run');
            const resetBtn = document.getElementById('file-reset');
            const inputData = document.getElementById('input-data');
            const inputFileContent = document.getElementById('input-file-content');
            const outputFileContent = document.getElementById('output-file-content');
            const fileStatus = document.getElementById('file-status');
            const codeLines = [];
            for (let i = 1; i <= 28; i++) {
                codeLines.push(document.getElementById(`fcode-${i}`));
            }
            
            // 重置函数
            function resetDemo() {
                // 清除所有高亮
                codeLines.forEach(line => {
                    line.classList.remove('code-line-highlight');
                });
                
                // 重置内容
                inputFileContent.textContent = "(将显示输入文件内容)";
                outputFileContent.textContent = "(将显示输出文件内容)";
                fileStatus.textContent = "状态: 等待开始";
                fileStatus.classList.add('hidden');
            }
            
            // 运行演示
            runBtn.addEventListener('click', function() {
                resetDemo();
                fileStatus.classList.remove('hidden');
                
                // 获取输入数据
                const data = inputData.value;
                inputFileContent.textContent = data;
                
                // 步骤数组 - 每个步骤包含状态文本和要高亮的代码行
                const steps = [
                    { status: "包含必要的头文件", lines: [1, 2] },
                    { status: "创建文件流对象", lines: [7, 8] },
                    { status: "打开输入输出文件", lines: [11, 12] },
                    { status: "读取第一个整数: 3", lines: [16] },
                    { status: "计算平方: 3 × 3 = 9", lines: [18] },
                    { status: "写入结果到文件", lines: [20] },
                    { status: "读取第二个整数: 5", lines: [16] },
                    { status: "计算平方: 5 × 5 = 25", lines: [18] },
                    { status: "写入结果到文件", lines: [20] },
                    { status: "读取第三个整数: 7", lines: [16] },
                    { status: "计算平方: 7 × 7 = 49", lines: [18] },
                    { status: "写入结果到文件", lines: [20] },
                    { status: "读取第四个整数: 9", lines: [16] },
                    { status: "计算平方: 9 × 9 = 81", lines: [18] },
                    { status: "写入结果到文件", lines: [20] },
                    { status: "读取第五个整数: 11", lines: [16] },
                    { status: "计算平方: 11 × 11 = 121", lines: [18] },
                    { status: "写入结果到文件", lines: [20] },
                    { status: "文件读取完毕，退出循环", lines: [16, 21] },
                    { status: "关闭输入输出文件", lines: [24, 25] },
                    { status: "程序执行完成", lines: [27] }
                ];
                
                // 计算输入数据的平方结果
                const lines = data.split('\n');
                let output = "";
                lines.forEach(line => {
                    const num = parseInt(line.trim());
                    if (!isNaN(num)) {
                        output += (num * num) + "\n";
                    }
                });
                
                // 执行步骤动画
                let stepIndex = 0;
                const interval = setInterval(() => {
                    if (stepIndex >= steps.length) {
                        clearInterval(interval);
                        outputFileContent.textContent = output.trim();
                        fileStatus.textContent = "状态: 演示完成";
                        return;
                    }
                    
                    // 清除上一步的高亮
                    codeLines.forEach(line => {
                        line.classList.remove('code-line-highlight');
                    });
                    
                    // 设置当前步骤
                    const step = steps[stepIndex];
                    fileStatus.textContent = `状态: ${step.status}`;
                    
                    // 高亮当前步骤的代码行
                    step.lines.forEach(lineNum => {
                        if (codeLines[lineNum - 1]) {
                            codeLines[lineNum - 1].classList.add('code-line-highlight');
                        }
                    });
                    
                    // 如果到了写入结果的步骤，更新输出文件内容
                    if (step.status.includes("写入结果到文件")) {
                        const currentOutput = output.split('\n').slice(0, (stepIndex + 1) / 3).join('\n');
                        outputFileContent.textContent = currentOutput;
                    }
                    
                    stepIndex++;
                }, 1000);
            });
            
            // 重置按钮
            resetBtn.addEventListener('click', resetDemo);
        });
    </script>
</body>
</html>